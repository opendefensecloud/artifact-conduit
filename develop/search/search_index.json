{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"<p>Welcome to the Artifact Conduit Docs.</p> <p>TODO</p>"},{"location":"developer-guide/contributing/","title":"Contributors Guide","text":""},{"location":"developer-guide/contributing/#contributing","title":"Contributing","text":"<p>The ARC project uses OpenCode Gitlab to manage reviews of pull requests. https://devenv.sh is used to provide reproducible developer environments.</p>"},{"location":"developer-guide/dod/","title":"Definition of Done","text":"<p>TODO</p>"},{"location":"developer-guide/working-with-docs/","title":"Documentation Setup","text":"<p>The documentation of the ARC project is written primarily using Markdown. All documentation related content can be found in https://go.opendefense.cloud/arc/-/wikis/home. New content also should be added there.</p>"},{"location":"developer-guide/adrs/000-Use-Markdown-Architectural-Decision-Records/","title":"000 Use Markdown Architectural Decision Records","text":""},{"location":"developer-guide/adrs/000-Use-Markdown-Architectural-Decision-Records/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>We want to record architectural decisions made in this project independent whether decisions concern the architecture (\"architectural decision record\"), the code, or other fields. Which format and structure should these records follow?</p>"},{"location":"developer-guide/adrs/000-Use-Markdown-Architectural-Decision-Records/#considered-options","title":"Considered Options","text":"<ul> <li>MADR\u00a04.0.0 \u2013 The Markdown Architectural Decision Records</li> <li>Michael Nygard's template\u00a0\u2013 The first incarnation of the term \"ADR\"</li> <li>Sustainable Architectural Decisions\u00a0\u2013 The Y-Statements</li> <li>Other templates listed at\u00a0https://github.com/joelparkerhenderson/architecture_decision_record</li> <li>Formless \u2013 No conventions for file format and structure</li> </ul>"},{"location":"developer-guide/adrs/000-Use-Markdown-Architectural-Decision-Records/#decision-outcome","title":"Decision Outcome","text":"<p>Chosen option: \"MADR 4.0.0\", because</p> <ul> <li>Implicit assumptions should be made explicit. Design documentation is important to enable people understanding the decisions later on. See also\u00a0\"A rational design process: How and why to fake it\".</li> <li>MADR allows for structured capturing of any decision.</li> <li>The MADR format is lean and fits our development style.</li> <li>The MADR structure is comprehensible and facilitates usage &amp; maintenance.</li> <li>The MADR project is vivid.</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/","title":"001 ARC Architecture","text":""},{"location":"developer-guide/adrs/001-ARC-Architecture/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>This ADR is about finding the right architecture for the ARC suite of services based on the knowledge gained during the internal predecessors of this project.</p>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#glossary","title":"Glossary","text":"<ul> <li><code>arcctl</code>: Command line utility to interact with the ARC API.</li> <li><code>Order</code>: Represents an order of one or more artifacts. Even ordering artifacts that may exist in the future can be reference here using semver expressions for example.</li> <li><code>OrderFragment</code>: Represents a single artifact order which is part of an <code>Order</code>.</li> <li><code>OrderTypeDefinition</code>: Defines rules and defaults for a specific order type like 'OCI'. References a certain workflow to use for that type.</li> <li><code>Endpoint</code>: General term for source or destination. Can be a source or destination for artifacts. Includes optional credentials to access it.</li> <li><code>WorkflowTemplate</code>: Argo Workflows, see https://argo-workflows.readthedocs.io/en/latest/fields/#workflowtemplate</li> <li><code>Workflow</code>: Argo Workflows, see https://argo-workflows.readthedocs.io/en/latest/fields/#workflow</li> <li><code>ARC API Server</code>: A Kubernetes Extension API Server which handles storage of ARC API</li> <li><code>Order Controller</code>: A Kubernetes Controller which reconciles <code>Orders</code>, splits up <code>Order</code> resources into <code>OrderFragment</code> Resources, creates <code>Workflow</code> resources for necessary workload</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#design-advantages-of-utilizing-kubernetes-operators","title":"Design Advantages of utilizing Kubernetes Operators","text":"<ul> <li>Native Declarative Management</li> <li>End users manage artifact lifecycle via <code>kubectl</code> or GitOps like any other Kubernetes resource.</li> <li>Resiliency</li> <li>If a worker Pod fails mid-transfer, Kubernetes reschedules the job automatically.</li> <li>Horizontal Scalability</li> <li>Controller and workers can scale independently.</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#considered-options","title":"Considered Options","text":""},{"location":"developer-guide/adrs/001-ARC-Architecture/#solution-a","title":"Solution A","text":""},{"location":"developer-guide/adrs/001-ARC-Architecture/#technology","title":"Technology","text":"<ul> <li>Instead of CRDs, <code>ARC</code> uses an Extension API Server via the Kubernetes API Aggregation Layer to handle API requests.</li> <li>This gives it the possibility to use a dedicated etcd or a even more suitable storage backend for the high amount of resources and status information in case this is necessary.</li> <li>While <code>etcd</code> still can be used as storage backend, it is one separated from the <code>etcd</code> used by the Kubernetes control plane and reduces the risk of bringing the whole cluster into trouble.</li> <li>Additional links</li> <li>https://github.com/kubernetes-sigs/apiserver-runtime</li> <li>https://github.com/kubernetes/sample-apiserver/tree/master</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#architecture-diagram","title":"Architecture Diagram","text":""},{"location":"developer-guide/adrs/001-ARC-Architecture/#pros","title":"Pros","text":"<ul> <li>Usin dedicated etcd does not clutter the infra etcd</li> <li>Storage can be changed later on if necessary</li> <li>Keep the declarative style of Kubernetes while having complete freedom on the API implementation</li> <li>Utilize Argo Workflows to handle the workflows necessary to process different artifact types without reinventing the wheel</li> <li>Optionally use Kueue to handle quotas and enhanced scheduling</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#cons","title":"Cons","text":"<ul> <li>Building addon apiservers directly on the raw api-machinery libraries requires non-trivial code that must be maintained and rebased as the raw libraries change.</li> <li>Steep learning curve when starting the project and steeper learning curve when joining the project.</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#solution-b","title":"Solution B","text":"<ul> <li>CRDs are used to interact with ARC via the Kubernetes API Server.</li> <li>Namespaces are used to separate resources in a multi-tenant environment.</li> <li>Several operators come into play which reconcile the different custom resources.</li> <li>A sharding mechanism is implemented to be able to scale the workers horizontally and give every worker a given chunk of resources to reconcile.</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#pros_1","title":"Pros","text":"<ul> <li>CRDs and Kubernetes are relatively simple to implement</li> <li>AuthN &amp; AuthZ are included with Kubernetes</li> <li>Storage via etcd included with Kubernetes</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#cons_1","title":"Cons","text":"<ul> <li>Storage may be limited by etcd and can bring the control plane of Kubernetes into trouble if too many resources are present</li> <li>The necessity to implement sharding may be hard work and error prone</li> <li>Thus said it may not scale in way necessary for such a solution</li> <li>The concept of Kubernetes Operators might not fit the problem</li> <li>ARC handles only things outside of Kubernetes</li> <li>Tight coupling between the software and the hosting</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#solution-c","title":"Solution C","text":"<ul> <li>This solution doesn't stick to declarative Kubernetes in any way and provides it's own opinionated API.</li> <li>Runs based on Kubernetes without being part of it's API</li> <li>AuthN &amp; AuthZ based on OIDC and is independent of Kubernetes cluster hosting it</li> <li>Uses message queueing for being able to have multiple workers scaling horizontally</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#pros_2","title":"Pros","text":"<ul> <li>Free from Kubernetes boundaries</li> <li>Storage</li> <li>AuthN &amp; AuthZ</li> <li>Scaling issues</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#cons_2","title":"Cons","text":"<ul> <li>AuthN &amp; AuthZ must be implemented</li> <li>Own Database must be used</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#solution-ca","title":"Solution C.A","text":"<ul> <li>Uses a classical CRUD based approach to store data</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#solution-cb","title":"Solution C.B","text":"<ul> <li>Uses Event Sourcing to give full auditability of every change at any given time in the system</li> </ul>"},{"location":"developer-guide/adrs/001-ARC-Architecture/#decision-outcome","title":"Decision Outcome","text":"<p>Chosen Option: Solution A</p> <p>//TODO explain in detail why</p>"},{"location":"developer-guide/adrs/002-ARC-API/","title":"002 ARC API","text":""},{"location":"developer-guide/adrs/002-ARC-API/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>This ADR is about finding the right API for ARC.</p>"},{"location":"developer-guide/adrs/002-ARC-API/#proposed-solution","title":"Proposed Solution","text":"<p>Options were discussed and documented here: https://app.bwi.conceptboard.com/board/u9c0-4nk5-rrhd-knre-6cfn</p> <pre><code>apiVersion: arc.bwi.de/v1alpha1\nkind: Order\nmetadata:\n  name: example-order\nspec:\n  defaults:\n    srcRef:\n      name: docker-hub\n      namespace: default # optional\n    dstRef:\n      name: internal-registry\n  artifacts:\n    - type: oci # artifactType, correcesponds to workflow\n      dstRef:\n        name: other-internal-registry\n        namespace: default # optional\n      spec:\n        image: library/alpine:3.18\n        override: myteam/alpine:3.18-dev # default alpine:3.18; support CEL?\n    - type: oci\n      spec:\n        image: library/ubuntu:1.0\n    - type: helm\n      srcRef:\n        name: jetstack-helm\n      dstRef:\n        name: internal-helm-registry\n      spec:\n        name: cert-manager\n        version: \"47.11\"\n        override: helm-charts/cert-manager:47.11\n</code></pre> <pre><code>apiVersion: arc.bwi.de/v1alpha1\nkind: Fragment\nmetadata:\n  name: example-order-1 # sha256 for procedural\nspec:\n  type: oci # artifactType, correcesponds to workflow\n  srcRef: # required\n    name: lala\n  dstRef: #required\n    name: other-internal-registry\n    namespace: default # optional\n  spec:\n    image: library/alpine:3.18\n    override: myteam/alpine:3.18-dev # default alpine:3.18; support CEL?\n</code></pre> <pre><code>apiVersion: arc.bwi.de/v1alpha1\nkind: Endpoint\nmetadata:\n  name: internal-registry\nspec:\n  type: oci # Endpoint Type! set valid types on controller manager?\n  remoteURL: https://artifactory.example.com/artifactory/ace-oci-local\n  secretRef: # STANDARDIZED!\n    name: internal-registry-credentials\n  usage: PullOnly | PushOnly | All # enum\n</code></pre> <pre><code>apiVersion: arc.bwi.de/v1alpha1\nkind: ArtifactTypeDefinition\nmetadata:\n  name: oci\nspec:\n  rules:\n    srcTypes:\n    - s3 # Endpoint Types!\n    - oci\n    - helm\n    dstTypes:\n    - oci\n  defaults:\n    dstRef: internal-registry\n  workflowTemplateRef: # argo.Workflow\n</code></pre>"},{"location":"operator-manual/installation/","title":"Installation","text":"<p>TODO</p>"},{"location":"operator-manual/new-features/","title":"New Features","text":"<p>TODO</p>"},{"location":"operator-manual/releases/","title":"Releases","text":"<p>TODO</p>"},{"location":"operator-manual/security/","title":"Security","text":"<p>TODO</p>"},{"location":"operator-manual/upgrading/","title":"Upgrading","text":"<p>TODO</p>"},{"location":"user-guide/core-concepts/","title":"Core Concepts","text":""},{"location":"user-guide/custom-resources/order/","title":"Order","text":""}]}